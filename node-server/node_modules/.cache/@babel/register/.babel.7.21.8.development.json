{"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Spring\\\\straight-blue-wave\\\\node-server\\\\src\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Spring\\\\straight-blue-wave\\\\node-server\",\"filename\":\"C:\\\\Spring\\\\straight-blue-wave\\\\node-server\\\\src\\\\server.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Spring\\\\straight-blue-wave\\\\node-server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-private-methods\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-numeric-separator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"NumericLiteral\":{\"enter\":[null]},\"BigIntLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-json-strings\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-catch-binding\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"CatchClause\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-async-generator-functions\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-escapes\",\"visitor\":{\"Identifier\":{\"enter\":[null]},\"TemplateElement\":{\"enter\":[null]},\"_exploded\":true,\"StringLiteral\":{\"enter\":[null]},\"DirectiveLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"_exploded\":true,\"BlockStatement\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"_verified\":true,\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectPattern\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"regenerator-transform\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-member-expression-literals\",\"visitor\":{\"MemberExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-property-literals\",\"visitor\":{\"ObjectProperty\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-reserved-words\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"Identifier\":{\"enter\":[null,null]},\"JSXIdentifier\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.21.8:development":{"value":{"code":"\"use strict\";\n\nvar _http = _interopRequireDefault(require(\"http\"));\nvar _socket = _interopRequireDefault(require(\"socket.io\"));\nvar _express = _interopRequireDefault(require(\"express\"));\nvar _cors = _interopRequireDefault(require(\"cors\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n// 추가\n\nvar path = require('path');\nvar app = (0, _express[\"default\"])();\n\n// app.use(cors({\n//   origin: 'http://172.26.1.126:8002'\n// }));\n\napp.use(_express[\"default\"][\"static\"](path.join(__dirname, \"/client/build\")));\n\n// app.set(\"view engine\", \"pug\");\n// app.set(\"views\", __dirname + \"/views\");\n// app.get(\"/\", (_, res) => res.render(\"home\"));\n// app.get(\"/*\", (_, res) => res.redirect(\"/\"));\n\napp.get(\"*\", function (req, res) {\n  res.sendFile(path.join(__dirname + '/build/index.html'));\n});\nvar httpServer = _http[\"default\"].createServer(app);\nvar wsServer = (0, _socket[\"default\"])(httpServer);\n// const wsServer = SocketIO(httpServer, {\n//   cors: {\n//     origin: [\"http://localhost:3000\", \"http://172.26.20.111:3000\"], // 클라이언트 도메인을 허용합니다.\n//     methods: [\"GET\", \"POST\"],\n//   },\n// });\n\nvar roomObjArr = [\n  // {\n  //   roomName,\n  //   currentNum,\n  //   users: [\n  //     {\n  //       socketId,\n  //       nickname,\n  //     },\n  //   ],\n  // },\n];\nvar MAXIMUM = 5;\nwsServer.on(\"connection\", function (socket) {\n  var myRoomName = null;\n  // let myNickname = null;\n\n  socket.on(\"join_room\", function (roomName) {\n    myRoomName = roomName;\n    // myNickname = nickname;\n\n    var isRoomExist = false;\n    var targetRoomObj = null;\n\n    // forEach를 사용하지 않는 이유: callback함수를 사용하기 때문에 return이 효용없음.\n    for (var i = 0; i < roomObjArr.length; ++i) {\n      if (roomObjArr[i].roomName === roomName) {\n        // Reject join the room\n        if (roomObjArr[i].currentNum >= MAXIMUM) {\n          socket.emit(\"reject_join\");\n          return;\n        }\n        isRoomExist = true;\n        targetRoomObj = roomObjArr[i];\n        break;\n      }\n    }\n\n    // Create room\n    if (!isRoomExist) {\n      targetRoomObj = {\n        roomName: roomName,\n        currentNum: 0,\n        users: []\n      };\n      roomObjArr.push(targetRoomObj);\n    }\n\n    //Join the room\n    targetRoomObj.users.push({\n      socketId: socket.id\n    });\n    ++targetRoomObj.currentNum;\n    socket.join(roomName);\n    socket.emit(\"accept_join\", targetRoomObj.users);\n  });\n  socket.on(\"offer\", function (offer, remoteSocketId) {\n    socket.to(remoteSocketId).emit(\"offer\", offer, socket.id);\n  });\n  socket.on(\"answer\", function (answer, remoteSocketId) {\n    socket.to(remoteSocketId).emit(\"answer\", answer, socket.id);\n  });\n  socket.on(\"ice\", function (ice, remoteSocketId) {\n    socket.to(remoteSocketId).emit(\"ice\", ice, socket.id);\n  });\n  socket.on(\"chat\", function (message, roomName) {\n    socket.to(roomName).emit(\"chat\", message);\n  });\n  socket.on(\"disconnecting\", function () {\n    socket.to(myRoomName).emit(\"leave_room\", socket.id);\n    var isRoomEmpty = false;\n    for (var i = 0; i < roomObjArr.length; ++i) {\n      if (roomObjArr[i].roomName === myRoomName) {\n        var newUsers = roomObjArr[i].users.filter(function (user) {\n          return user.socketId != socket.id;\n        });\n        roomObjArr[i].users = newUsers;\n        --roomObjArr[i].currentNum;\n        if (roomObjArr[i].currentNum == 0) {\n          isRoomEmpty = true;\n        }\n      }\n    }\n\n    // Delete room\n    if (isRoomEmpty) {\n      var newRoomObjArr = roomObjArr.filter(function (roomObj) {\n        return roomObj.currentNum != 0;\n      });\n      roomObjArr = newRoomObjArr;\n    }\n  });\n});\nvar handleListen = function handleListen() {\n  return console.log(\"Listening on http://localhost:4000\");\n};\nhttpServer.listen(4000, handleListen);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaHR0cCIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX3NvY2tldCIsIl9leHByZXNzIiwiX2NvcnMiLCJvYmoiLCJfX2VzTW9kdWxlIiwicGF0aCIsImFwcCIsImV4cHJlc3MiLCJ1c2UiLCJqb2luIiwiX19kaXJuYW1lIiwiZ2V0IiwicmVxIiwicmVzIiwic2VuZEZpbGUiLCJodHRwU2VydmVyIiwiaHR0cCIsImNyZWF0ZVNlcnZlciIsIndzU2VydmVyIiwiU29ja2V0SU8iLCJyb29tT2JqQXJyIiwiTUFYSU1VTSIsIm9uIiwic29ja2V0IiwibXlSb29tTmFtZSIsInJvb21OYW1lIiwiaXNSb29tRXhpc3QiLCJ0YXJnZXRSb29tT2JqIiwiaSIsImxlbmd0aCIsImN1cnJlbnROdW0iLCJlbWl0IiwidXNlcnMiLCJwdXNoIiwic29ja2V0SWQiLCJpZCIsIm9mZmVyIiwicmVtb3RlU29ja2V0SWQiLCJ0byIsImFuc3dlciIsImljZSIsIm1lc3NhZ2UiLCJpc1Jvb21FbXB0eSIsIm5ld1VzZXJzIiwiZmlsdGVyIiwidXNlciIsIm5ld1Jvb21PYmpBcnIiLCJyb29tT2JqIiwiaGFuZGxlTGlzdGVuIiwiY29uc29sZSIsImxvZyIsImxpc3RlbiJdLCJzb3VyY2VSb290IjoiQzpcXFNwcmluZ1xcc3RyYWlnaHQtYmx1ZS13YXZlXFxub2RlLXNlcnZlclxcc3JjXFwiLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgaHR0cCBmcm9tIFwiaHR0cFwiO1xyXG5pbXBvcnQgU29ja2V0SU8gZnJvbSBcInNvY2tldC5pb1wiO1xyXG5pbXBvcnQgZXhwcmVzcyBmcm9tIFwiZXhwcmVzc1wiO1xyXG5pbXBvcnQgY29ycyBmcm9tIFwiY29yc1wiOyAvLyDstpTqsIBcclxuXHJcblxyXG5cclxuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcclxuY29uc3QgYXBwID0gZXhwcmVzcygpO1xyXG5cclxuLy8gYXBwLnVzZShjb3JzKHtcclxuLy8gICBvcmlnaW46ICdodHRwOi8vMTcyLjI2LjEuMTI2OjgwMDInXHJcbi8vIH0pKTtcclxuXHJcbmFwcC51c2UoZXhwcmVzcy5zdGF0aWMocGF0aC5qb2luKF9fZGlybmFtZSwgXCIvY2xpZW50L2J1aWxkXCIpKSk7XHJcblxyXG4vLyBhcHAuc2V0KFwidmlldyBlbmdpbmVcIiwgXCJwdWdcIik7XHJcbi8vIGFwcC5zZXQoXCJ2aWV3c1wiLCBfX2Rpcm5hbWUgKyBcIi92aWV3c1wiKTtcclxuLy8gYXBwLmdldChcIi9cIiwgKF8sIHJlcykgPT4gcmVzLnJlbmRlcihcImhvbWVcIikpO1xyXG4vLyBhcHAuZ2V0KFwiLypcIiwgKF8sIHJlcykgPT4gcmVzLnJlZGlyZWN0KFwiL1wiKSk7XHJcblxyXG5hcHAuZ2V0KFwiKlwiLCAocmVxLCByZXMpID0+IHtcclxuICByZXMuc2VuZEZpbGUocGF0aC5qb2luKF9fZGlybmFtZSArICcvYnVpbGQvaW5kZXguaHRtbCcpKTtcclxufSlcclxuXHJcblxyXG5jb25zdCBodHRwU2VydmVyID0gaHR0cC5jcmVhdGVTZXJ2ZXIoYXBwKTtcclxuY29uc3Qgd3NTZXJ2ZXIgPSBTb2NrZXRJTyhodHRwU2VydmVyKTtcclxuLy8gY29uc3Qgd3NTZXJ2ZXIgPSBTb2NrZXRJTyhodHRwU2VydmVyLCB7XHJcbi8vICAgY29yczoge1xyXG4vLyAgICAgb3JpZ2luOiBbXCJodHRwOi8vbG9jYWxob3N0OjMwMDBcIiwgXCJodHRwOi8vMTcyLjI2LjIwLjExMTozMDAwXCJdLCAvLyDtgbTrnbzsnbTslrjtirgg64+E66mU7J247J2EIO2XiOyaqe2VqeuLiOuLpC5cclxuLy8gICAgIG1ldGhvZHM6IFtcIkdFVFwiLCBcIlBPU1RcIl0sXHJcbi8vICAgfSxcclxuLy8gfSk7XHJcblxyXG5sZXQgcm9vbU9iakFyciA9IFtcclxuICAvLyB7XHJcbiAgLy8gICByb29tTmFtZSxcclxuICAvLyAgIGN1cnJlbnROdW0sXHJcbiAgLy8gICB1c2VyczogW1xyXG4gIC8vICAgICB7XHJcbiAgLy8gICAgICAgc29ja2V0SWQsXHJcbiAgLy8gICAgICAgbmlja25hbWUsXHJcbiAgLy8gICAgIH0sXHJcbiAgLy8gICBdLFxyXG4gIC8vIH0sXHJcbl07XHJcbmNvbnN0IE1BWElNVU0gPSA1O1xyXG5cclxud3NTZXJ2ZXIub24oXCJjb25uZWN0aW9uXCIsIChzb2NrZXQpID0+IHtcclxuICBsZXQgbXlSb29tTmFtZSA9IG51bGw7XHJcbiAgLy8gbGV0IG15Tmlja25hbWUgPSBudWxsO1xyXG5cclxuICBzb2NrZXQub24oXCJqb2luX3Jvb21cIiwgKHJvb21OYW1lKSA9PiB7XHJcbiAgICBteVJvb21OYW1lID0gcm9vbU5hbWU7XHJcbiAgICAvLyBteU5pY2tuYW1lID0gbmlja25hbWU7XHJcblxyXG4gICAgbGV0IGlzUm9vbUV4aXN0ID0gZmFsc2U7XHJcbiAgICBsZXQgdGFyZ2V0Um9vbU9iaiA9IG51bGw7XHJcblxyXG4gICAgLy8gZm9yRWFjaOulvCDsgqzsmqntlZjsp4Ag7JWK64qUIOydtOycoDogY2FsbGJhY2vtlajsiJjrpbwg7IKs7Jqp7ZWY6riwIOuVjOusuOyXkCByZXR1cm7snbQg7Zqo7Jqp7JeG7J2MLlxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByb29tT2JqQXJyLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgIGlmIChyb29tT2JqQXJyW2ldLnJvb21OYW1lID09PSByb29tTmFtZSkge1xyXG4gICAgICAgIC8vIFJlamVjdCBqb2luIHRoZSByb29tXHJcbiAgICAgICAgaWYgKHJvb21PYmpBcnJbaV0uY3VycmVudE51bSA+PSBNQVhJTVVNKSB7XHJcbiAgICAgICAgICBzb2NrZXQuZW1pdChcInJlamVjdF9qb2luXCIpO1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaXNSb29tRXhpc3QgPSB0cnVlO1xyXG4gICAgICAgIHRhcmdldFJvb21PYmogPSByb29tT2JqQXJyW2ldO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ3JlYXRlIHJvb21cclxuICAgIGlmICghaXNSb29tRXhpc3QpIHtcclxuICAgICAgdGFyZ2V0Um9vbU9iaiA9IHtcclxuICAgICAgICByb29tTmFtZSxcclxuICAgICAgICBjdXJyZW50TnVtOiAwLFxyXG4gICAgICAgIHVzZXJzOiBbXSxcclxuICAgICAgfTtcclxuICAgICAgcm9vbU9iakFyci5wdXNoKHRhcmdldFJvb21PYmopO1xyXG4gICAgfVxyXG5cclxuICAgIC8vSm9pbiB0aGUgcm9vbVxyXG4gICAgdGFyZ2V0Um9vbU9iai51c2Vycy5wdXNoKHtcclxuICAgICAgc29ja2V0SWQ6IHNvY2tldC5pZCxcclxuICAgICAgXHJcbiAgICB9KTtcclxuICAgICsrdGFyZ2V0Um9vbU9iai5jdXJyZW50TnVtO1xyXG5cclxuICAgIHNvY2tldC5qb2luKHJvb21OYW1lKTtcclxuICAgIHNvY2tldC5lbWl0KFwiYWNjZXB0X2pvaW5cIiwgdGFyZ2V0Um9vbU9iai51c2Vycyk7XHJcbiAgfSk7XHJcblxyXG4gIHNvY2tldC5vbihcIm9mZmVyXCIsIChvZmZlciwgcmVtb3RlU29ja2V0SWQpID0+IHtcclxuICAgIHNvY2tldC50byhyZW1vdGVTb2NrZXRJZCkuZW1pdChcIm9mZmVyXCIsIG9mZmVyLCBzb2NrZXQuaWQpO1xyXG4gIH0pO1xyXG5cclxuICBzb2NrZXQub24oXCJhbnN3ZXJcIiwgKGFuc3dlciwgcmVtb3RlU29ja2V0SWQpID0+IHtcclxuICAgIHNvY2tldC50byhyZW1vdGVTb2NrZXRJZCkuZW1pdChcImFuc3dlclwiLCBhbnN3ZXIsIHNvY2tldC5pZCk7XHJcbiAgfSk7XHJcblxyXG4gIHNvY2tldC5vbihcImljZVwiLCAoaWNlLCByZW1vdGVTb2NrZXRJZCkgPT4ge1xyXG4gICAgc29ja2V0LnRvKHJlbW90ZVNvY2tldElkKS5lbWl0KFwiaWNlXCIsIGljZSwgc29ja2V0LmlkKTtcclxuICB9KTtcclxuXHJcbiAgc29ja2V0Lm9uKFwiY2hhdFwiLCAobWVzc2FnZSwgcm9vbU5hbWUpID0+IHtcclxuICAgIHNvY2tldC50byhyb29tTmFtZSkuZW1pdChcImNoYXRcIiwgbWVzc2FnZSk7XHJcbiAgfSk7XHJcblxyXG4gIHNvY2tldC5vbihcImRpc2Nvbm5lY3RpbmdcIiwgKCkgPT4ge1xyXG4gICAgc29ja2V0LnRvKG15Um9vbU5hbWUpLmVtaXQoXCJsZWF2ZV9yb29tXCIsIHNvY2tldC5pZCk7XHJcblxyXG4gICAgbGV0IGlzUm9vbUVtcHR5ID0gZmFsc2U7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJvb21PYmpBcnIubGVuZ3RoOyArK2kpIHtcclxuICAgICAgaWYgKHJvb21PYmpBcnJbaV0ucm9vbU5hbWUgPT09IG15Um9vbU5hbWUpIHtcclxuICAgICAgICBjb25zdCBuZXdVc2VycyA9IHJvb21PYmpBcnJbaV0udXNlcnMuZmlsdGVyKFxyXG4gICAgICAgICAgKHVzZXIpID0+IHVzZXIuc29ja2V0SWQgIT0gc29ja2V0LmlkXHJcbiAgICAgICAgKTtcclxuICAgICAgICByb29tT2JqQXJyW2ldLnVzZXJzID0gbmV3VXNlcnM7XHJcbiAgICAgICAgLS1yb29tT2JqQXJyW2ldLmN1cnJlbnROdW07XHJcblxyXG4gICAgICAgIGlmIChyb29tT2JqQXJyW2ldLmN1cnJlbnROdW0gPT0gMCkge1xyXG4gICAgICAgICAgaXNSb29tRW1wdHkgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIERlbGV0ZSByb29tXHJcbiAgICBpZiAoaXNSb29tRW1wdHkpIHtcclxuICAgICAgY29uc3QgbmV3Um9vbU9iakFyciA9IHJvb21PYmpBcnIuZmlsdGVyKFxyXG4gICAgICAgIChyb29tT2JqKSA9PiByb29tT2JqLmN1cnJlbnROdW0gIT0gMFxyXG4gICAgICApO1xyXG4gICAgICByb29tT2JqQXJyID0gbmV3Um9vbU9iakFycjtcclxuICAgIH1cclxuICB9KTtcclxufSk7XHJcblxyXG5jb25zdCBoYW5kbGVMaXN0ZW4gPSAoKSA9PiBjb25zb2xlLmxvZyhgTGlzdGVuaW5nIG9uIGh0dHA6Ly9sb2NhbGhvc3Q6NDAwMGApO1xyXG5odHRwU2VydmVyLmxpc3Rlbig0MDAwLCBoYW5kbGVMaXN0ZW4pO1xyXG4iXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBQUEsS0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsT0FBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsUUFBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUcsS0FBQSxHQUFBSixzQkFBQSxDQUFBQyxPQUFBO0FBQXdCLFNBQUFELHVCQUFBSyxHQUFBLFdBQUFBLEdBQUEsSUFBQUEsR0FBQSxDQUFBQyxVQUFBLEdBQUFELEdBQUEsZ0JBQUFBLEdBQUE7QUFBQzs7QUFJekIsSUFBTUUsSUFBSSxHQUFHTixPQUFPLENBQUMsTUFBTSxDQUFDO0FBQzVCLElBQU1PLEdBQUcsR0FBRyxJQUFBQyxtQkFBTyxFQUFDLENBQUM7O0FBRXJCO0FBQ0E7QUFDQTs7QUFFQUQsR0FBRyxDQUFDRSxHQUFHLENBQUNELG1CQUFPLFVBQU8sQ0FBQ0YsSUFBSSxDQUFDSSxJQUFJLENBQUNDLFNBQVMsRUFBRSxlQUFlLENBQUMsQ0FBQyxDQUFDOztBQUU5RDtBQUNBO0FBQ0E7QUFDQTs7QUFFQUosR0FBRyxDQUFDSyxHQUFHLENBQUMsR0FBRyxFQUFFLFVBQUNDLEdBQUcsRUFBRUMsR0FBRyxFQUFLO0VBQ3pCQSxHQUFHLENBQUNDLFFBQVEsQ0FBQ1QsSUFBSSxDQUFDSSxJQUFJLENBQUNDLFNBQVMsR0FBRyxtQkFBbUIsQ0FBQyxDQUFDO0FBQzFELENBQUMsQ0FBQztBQUdGLElBQU1LLFVBQVUsR0FBR0MsZ0JBQUksQ0FBQ0MsWUFBWSxDQUFDWCxHQUFHLENBQUM7QUFDekMsSUFBTVksUUFBUSxHQUFHLElBQUFDLGtCQUFRLEVBQUNKLFVBQVUsQ0FBQztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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","map":{"version":3,"names":["_http","_interopRequireDefault","require","_socket","_express","_cors","obj","__esModule","path","app","express","use","join","__dirname","get","req","res","sendFile","httpServer","http","createServer","wsServer","SocketIO","roomObjArr","MAXIMUM","on","socket","myRoomName","roomName","isRoomExist","targetRoomObj","i","length","currentNum","emit","users","push","socketId","id","offer","remoteSocketId","to","answer","ice","message","isRoomEmpty","newUsers","filter","user","newRoomObjArr","roomObj","handleListen","console","log","listen"],"sourceRoot":"C:\\Spring\\straight-blue-wave\\node-server\\src\\","sources":["server.js"],"sourcesContent":["import http from \"http\";\r\nimport SocketIO from \"socket.io\";\r\nimport express from \"express\";\r\nimport cors from \"cors\"; // 추가\r\n\r\n\r\n\r\nconst path = require('path');\r\nconst app = express();\r\n\r\n// app.use(cors({\r\n//   origin: 'http://172.26.1.126:8002'\r\n// }));\r\n\r\napp.use(express.static(path.join(__dirname, \"/client/build\")));\r\n\r\n// app.set(\"view engine\", \"pug\");\r\n// app.set(\"views\", __dirname + \"/views\");\r\n// app.get(\"/\", (_, res) => res.render(\"home\"));\r\n// app.get(\"/*\", (_, res) => res.redirect(\"/\"));\r\n\r\napp.get(\"*\", (req, res) => {\r\n  res.sendFile(path.join(__dirname + '/build/index.html'));\r\n})\r\n\r\n\r\nconst httpServer = http.createServer(app);\r\nconst wsServer = SocketIO(httpServer);\r\n// const wsServer = SocketIO(httpServer, {\r\n//   cors: {\r\n//     origin: [\"http://localhost:3000\", \"http://172.26.20.111:3000\"], // 클라이언트 도메인을 허용합니다.\r\n//     methods: [\"GET\", \"POST\"],\r\n//   },\r\n// });\r\n\r\nlet roomObjArr = [\r\n  // {\r\n  //   roomName,\r\n  //   currentNum,\r\n  //   users: [\r\n  //     {\r\n  //       socketId,\r\n  //       nickname,\r\n  //     },\r\n  //   ],\r\n  // },\r\n];\r\nconst MAXIMUM = 5;\r\n\r\nwsServer.on(\"connection\", (socket) => {\r\n  let myRoomName = null;\r\n  // let myNickname = null;\r\n\r\n  socket.on(\"join_room\", (roomName) => {\r\n    myRoomName = roomName;\r\n    // myNickname = nickname;\r\n\r\n    let isRoomExist = false;\r\n    let targetRoomObj = null;\r\n\r\n    // forEach를 사용하지 않는 이유: callback함수를 사용하기 때문에 return이 효용없음.\r\n    for (let i = 0; i < roomObjArr.length; ++i) {\r\n      if (roomObjArr[i].roomName === roomName) {\r\n        // Reject join the room\r\n        if (roomObjArr[i].currentNum >= MAXIMUM) {\r\n          socket.emit(\"reject_join\");\r\n          return;\r\n        }\r\n\r\n        isRoomExist = true;\r\n        targetRoomObj = roomObjArr[i];\r\n        break;\r\n      }\r\n    }\r\n\r\n    // Create room\r\n    if (!isRoomExist) {\r\n      targetRoomObj = {\r\n        roomName,\r\n        currentNum: 0,\r\n        users: [],\r\n      };\r\n      roomObjArr.push(targetRoomObj);\r\n    }\r\n\r\n    //Join the room\r\n    targetRoomObj.users.push({\r\n      socketId: socket.id,\r\n      \r\n    });\r\n    ++targetRoomObj.currentNum;\r\n\r\n    socket.join(roomName);\r\n    socket.emit(\"accept_join\", targetRoomObj.users);\r\n  });\r\n\r\n  socket.on(\"offer\", (offer, remoteSocketId) => {\r\n    socket.to(remoteSocketId).emit(\"offer\", offer, socket.id);\r\n  });\r\n\r\n  socket.on(\"answer\", (answer, remoteSocketId) => {\r\n    socket.to(remoteSocketId).emit(\"answer\", answer, socket.id);\r\n  });\r\n\r\n  socket.on(\"ice\", (ice, remoteSocketId) => {\r\n    socket.to(remoteSocketId).emit(\"ice\", ice, socket.id);\r\n  });\r\n\r\n  socket.on(\"chat\", (message, roomName) => {\r\n    socket.to(roomName).emit(\"chat\", message);\r\n  });\r\n\r\n  socket.on(\"disconnecting\", () => {\r\n    socket.to(myRoomName).emit(\"leave_room\", socket.id);\r\n\r\n    let isRoomEmpty = false;\r\n    for (let i = 0; i < roomObjArr.length; ++i) {\r\n      if (roomObjArr[i].roomName === myRoomName) {\r\n        const newUsers = roomObjArr[i].users.filter(\r\n          (user) => user.socketId != socket.id\r\n        );\r\n        roomObjArr[i].users = newUsers;\r\n        --roomObjArr[i].currentNum;\r\n\r\n        if (roomObjArr[i].currentNum == 0) {\r\n          isRoomEmpty = true;\r\n        }\r\n      }\r\n    }\r\n\r\n    // Delete room\r\n    if (isRoomEmpty) {\r\n      const newRoomObjArr = roomObjArr.filter(\r\n        (roomObj) => roomObj.currentNum != 0\r\n      );\r\n      roomObjArr = newRoomObjArr;\r\n    }\r\n  });\r\n});\r\n\r\nconst handleListen = () => console.log(`Listening on http://localhost:4000`);\r\nhttpServer.listen(4000, handleListen);\r\n"],"mappings":"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"}},"mtime":1683094541867}}