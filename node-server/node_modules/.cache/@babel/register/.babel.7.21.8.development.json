{"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Spring\\\\straight-blue-wave\\\\node-server\\\\src\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Spring\\\\straight-blue-wave\\\\node-server\",\"filename\":\"C:\\\\Spring\\\\straight-blue-wave\\\\node-server\\\\src\\\\server.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Spring\\\\straight-blue-wave\\\\node-server\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-private-methods\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-numeric-separator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"NumericLiteral\":{\"enter\":[null]},\"BigIntLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-json-strings\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-catch-binding\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"CatchClause\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-async-generator-functions\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-escapes\",\"visitor\":{\"Identifier\":{\"enter\":[null]},\"TemplateElement\":{\"enter\":[null]},\"_exploded\":true,\"StringLiteral\":{\"enter\":[null]},\"DirectiveLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"_exploded\":true,\"BlockStatement\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"_verified\":true,\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectPattern\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"regenerator-transform\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-member-expression-literals\",\"visitor\":{\"MemberExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-property-literals\",\"visitor\":{\"ObjectProperty\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-reserved-words\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"Identifier\":{\"enter\":[null,null]},\"JSXIdentifier\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.21.8:development":{"value":{"code":"\"use strict\";\n\nvar _http = _interopRequireDefault(require(\"http\"));\nvar _socket = _interopRequireDefault(require(\"socket.io\"));\nvar _express = _interopRequireDefault(require(\"express\"));\nvar _cors = _interopRequireDefault(require(\"cors\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n// 추가\n\nvar path = require('path');\nvar app = (0, _express[\"default\"])();\n\n//app.use(cors({\n// origin: 'http://192.168.0.79:8002'\n// }));\n\napp.use(_express[\"default\"][\"static\"](path.join(__dirname, \"/client/build\")));\n\n// app.set(\"view engine\", \"pug\");\n// app.set(\"views\", __dirname + \"/views\");\n// app.get(\"/\", (_, res) => res.render(\"home\"));\n// app.get(\"/*\", (_, res) => res.redirect(\"/\"));\n\napp.get(\"*\", function (req, res) {\n  res.sendFile(path.join(__dirname + '/build/index.html'));\n});\nvar httpServer = _http[\"default\"].createServer(app);\nvar wsServer = (0, _socket[\"default\"])(httpServer);\n// const wsServer = SocketIO(httpServer, {\n//   cors: {\n//     origin: [\"http://localhost:3000\", \"http://172.26.20.111:3000\"], // 클라이언트 도메인을 허용합니다.\n//     methods: [\"GET\", \"POST\"],\n//   },\n// });\n\nvar roomObjArr = [\n  // {\n  //   roomName,\n  //   currentNum,\n  //   users: [\n  //     {\n  //       socketId,\n  //       nickname,\n  //     },\n  //   ],\n  // },\n];\nvar MAXIMUM = 5;\nwsServer.on(\"connection\", function (socket) {\n  var myRoomName = null;\n  // let myNickname = null;\n\n  socket.on(\"join_room\", function (roomName) {\n    myRoomName = roomName;\n    // myNickname = nickname;\n\n    var isRoomExist = false;\n    var targetRoomObj = null;\n\n    // forEach를 사용하지 않는 이유: callback함수를 사용하기 때문에 return이 효용없음.\n    for (var i = 0; i < roomObjArr.length; ++i) {\n      if (roomObjArr[i].roomName === roomName) {\n        // Reject join the room\n        if (roomObjArr[i].currentNum >= MAXIMUM) {\n          socket.emit(\"reject_join\");\n          return;\n        }\n        isRoomExist = true;\n        targetRoomObj = roomObjArr[i];\n        break;\n      }\n    }\n\n    // Create room\n    if (!isRoomExist) {\n      targetRoomObj = {\n        roomName: roomName,\n        currentNum: 0,\n        users: []\n      };\n      roomObjArr.push(targetRoomObj);\n    }\n\n    //Join the room\n    targetRoomObj.users.push({\n      socketId: socket.id\n    });\n    ++targetRoomObj.currentNum;\n    socket.join(roomName);\n    socket.emit(\"accept_join\", targetRoomObj.users);\n  });\n  socket.on(\"offer\", function (offer, remoteSocketId) {\n    socket.to(remoteSocketId).emit(\"offer\", offer, socket.id);\n  });\n  socket.on(\"answer\", function (answer, remoteSocketId) {\n    socket.to(remoteSocketId).emit(\"answer\", answer, socket.id);\n  });\n  socket.on(\"ice\", function (ice, remoteSocketId) {\n    socket.to(remoteSocketId).emit(\"ice\", ice, socket.id);\n  });\n  socket.on(\"chat\", function (message, roomName) {\n    socket.to(roomName).emit(\"chat\", message);\n  });\n  socket.on(\"disconnecting\", function () {\n    socket.to(myRoomName).emit(\"leave_room\", socket.id);\n    var isRoomEmpty = false;\n    for (var i = 0; i < roomObjArr.length; ++i) {\n      if (roomObjArr[i].roomName === myRoomName) {\n        var newUsers = roomObjArr[i].users.filter(function (user) {\n          return user.socketId != socket.id;\n        });\n        roomObjArr[i].users = newUsers;\n        --roomObjArr[i].currentNum;\n        if (roomObjArr[i].currentNum == 0) {\n          isRoomEmpty = true;\n        }\n      }\n    }\n\n    // Delete room\n    if (isRoomEmpty) {\n      var newRoomObjArr = roomObjArr.filter(function (roomObj) {\n        return roomObj.currentNum != 0;\n      });\n      roomObjArr = newRoomObjArr;\n    }\n  });\n});\nvar handleListen = function handleListen() {\n  return console.log(\"Listening on http://localhost:4000\");\n};\nhttpServer.listen(4000, handleListen);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaHR0cCIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX3NvY2tldCIsIl9leHByZXNzIiwiX2NvcnMiLCJvYmoiLCJfX2VzTW9kdWxlIiwicGF0aCIsImFwcCIsImV4cHJlc3MiLCJ1c2UiLCJqb2luIiwiX19kaXJuYW1lIiwiZ2V0IiwicmVxIiwicmVzIiwic2VuZEZpbGUiLCJodHRwU2VydmVyIiwiaHR0cCIsImNyZWF0ZVNlcnZlciIsIndzU2VydmVyIiwiU29ja2V0SU8iLCJyb29tT2JqQXJyIiwiTUFYSU1VTSIsIm9uIiwic29ja2V0IiwibXlSb29tTmFtZSIsInJvb21OYW1lIiwiaXNSb29tRXhpc3QiLCJ0YXJnZXRSb29tT2JqIiwiaSIsImxlbmd0aCIsImN1cnJlbnROdW0iLCJlbWl0IiwidXNlcnMiLCJwdXNoIiwic29ja2V0SWQiLCJpZCIsIm9mZmVyIiwicmVtb3RlU29ja2V0SWQiLCJ0byIsImFuc3dlciIsImljZSIsIm1lc3NhZ2UiLCJpc1Jvb21FbXB0eSIsIm5ld1VzZXJzIiwiZmlsdGVyIiwidXNlciIsIm5ld1Jvb21PYmpBcnIiLCJyb29tT2JqIiwiaGFuZGxlTGlzdGVuIiwiY29uc29sZSIsImxvZyIsImxpc3RlbiJdLCJzb3VyY2VSb290IjoiQzpcXFNwcmluZ1xcc3RyYWlnaHQtYmx1ZS13YXZlXFxub2RlLXNlcnZlclxcc3JjXFwiLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgaHR0cCBmcm9tIFwiaHR0cFwiO1xyXG5pbXBvcnQgU29ja2V0SU8gZnJvbSBcInNvY2tldC5pb1wiO1xyXG5pbXBvcnQgZXhwcmVzcyBmcm9tIFwiZXhwcmVzc1wiO1xyXG5pbXBvcnQgY29ycyBmcm9tIFwiY29yc1wiOyAvLyDstpTqsIBcclxuXHJcblxyXG5cclxuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcclxuY29uc3QgYXBwID0gZXhwcmVzcygpO1xyXG5cclxuIC8vYXBwLnVzZShjb3JzKHtcclxuLy8gb3JpZ2luOiAnaHR0cDovLzE5Mi4xNjguMC43OTo4MDAyJ1xyXG4vLyB9KSk7XHJcblxyXG5hcHAudXNlKGV4cHJlc3Muc3RhdGljKHBhdGguam9pbihfX2Rpcm5hbWUsIFwiL2NsaWVudC9idWlsZFwiKSkpO1xyXG5cclxuLy8gYXBwLnNldChcInZpZXcgZW5naW5lXCIsIFwicHVnXCIpO1xyXG4vLyBhcHAuc2V0KFwidmlld3NcIiwgX19kaXJuYW1lICsgXCIvdmlld3NcIik7XHJcbi8vIGFwcC5nZXQoXCIvXCIsIChfLCByZXMpID0+IHJlcy5yZW5kZXIoXCJob21lXCIpKTtcclxuLy8gYXBwLmdldChcIi8qXCIsIChfLCByZXMpID0+IHJlcy5yZWRpcmVjdChcIi9cIikpO1xyXG5cclxuYXBwLmdldChcIipcIiwgKHJlcSwgcmVzKSA9PiB7XHJcbiAgcmVzLnNlbmRGaWxlKHBhdGguam9pbihfX2Rpcm5hbWUgKyAnL2J1aWxkL2luZGV4Lmh0bWwnKSk7XHJcbn0pXHJcblxyXG5cclxuY29uc3QgaHR0cFNlcnZlciA9IGh0dHAuY3JlYXRlU2VydmVyKGFwcCk7XHJcbmNvbnN0IHdzU2VydmVyID0gU29ja2V0SU8oaHR0cFNlcnZlcik7XHJcbi8vIGNvbnN0IHdzU2VydmVyID0gU29ja2V0SU8oaHR0cFNlcnZlciwge1xyXG4vLyAgIGNvcnM6IHtcclxuLy8gICAgIG9yaWdpbjogW1wiaHR0cDovL2xvY2FsaG9zdDozMDAwXCIsIFwiaHR0cDovLzE3Mi4yNi4yMC4xMTE6MzAwMFwiXSwgLy8g7YG065287J207Ja47Yq4IOuPhOuplOyduOydhCDtl4jsmqntlanri4jri6QuXHJcbi8vICAgICBtZXRob2RzOiBbXCJHRVRcIiwgXCJQT1NUXCJdLFxyXG4vLyAgIH0sXHJcbi8vIH0pO1xyXG5cclxubGV0IHJvb21PYmpBcnIgPSBbXHJcbiAgLy8ge1xyXG4gIC8vICAgcm9vbU5hbWUsXHJcbiAgLy8gICBjdXJyZW50TnVtLFxyXG4gIC8vICAgdXNlcnM6IFtcclxuICAvLyAgICAge1xyXG4gIC8vICAgICAgIHNvY2tldElkLFxyXG4gIC8vICAgICAgIG5pY2tuYW1lLFxyXG4gIC8vICAgICB9LFxyXG4gIC8vICAgXSxcclxuICAvLyB9LFxyXG5dO1xyXG5jb25zdCBNQVhJTVVNID0gNTtcclxuXHJcbndzU2VydmVyLm9uKFwiY29ubmVjdGlvblwiLCAoc29ja2V0KSA9PiB7XHJcbiAgbGV0IG15Um9vbU5hbWUgPSBudWxsO1xyXG4gIC8vIGxldCBteU5pY2tuYW1lID0gbnVsbDtcclxuXHJcbiAgc29ja2V0Lm9uKFwiam9pbl9yb29tXCIsIChyb29tTmFtZSkgPT4ge1xyXG4gICAgbXlSb29tTmFtZSA9IHJvb21OYW1lO1xyXG4gICAgLy8gbXlOaWNrbmFtZSA9IG5pY2tuYW1lO1xyXG5cclxuICAgIGxldCBpc1Jvb21FeGlzdCA9IGZhbHNlO1xyXG4gICAgbGV0IHRhcmdldFJvb21PYmogPSBudWxsO1xyXG5cclxuICAgIC8vIGZvckVhY2jrpbwg7IKs7Jqp7ZWY7KeAIOyViuuKlCDsnbTsnKA6IGNhbGxiYWNr7ZWo7IiY66W8IOyCrOyaqe2VmOq4sCDrlYzrrLjsl5AgcmV0dXJu7J20IO2aqOyaqeyXhuydjC5cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcm9vbU9iakFyci5sZW5ndGg7ICsraSkge1xyXG4gICAgICBpZiAocm9vbU9iakFycltpXS5yb29tTmFtZSA9PT0gcm9vbU5hbWUpIHtcclxuICAgICAgICAvLyBSZWplY3Qgam9pbiB0aGUgcm9vbVxyXG4gICAgICAgIGlmIChyb29tT2JqQXJyW2ldLmN1cnJlbnROdW0gPj0gTUFYSU1VTSkge1xyXG4gICAgICAgICAgc29ja2V0LmVtaXQoXCJyZWplY3Rfam9pblwiKTtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlzUm9vbUV4aXN0ID0gdHJ1ZTtcclxuICAgICAgICB0YXJnZXRSb29tT2JqID0gcm9vbU9iakFycltpXTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIENyZWF0ZSByb29tXHJcbiAgICBpZiAoIWlzUm9vbUV4aXN0KSB7XHJcbiAgICAgIHRhcmdldFJvb21PYmogPSB7XHJcbiAgICAgICAgcm9vbU5hbWUsXHJcbiAgICAgICAgY3VycmVudE51bTogMCxcclxuICAgICAgICB1c2VyczogW10sXHJcbiAgICAgIH07XHJcbiAgICAgIHJvb21PYmpBcnIucHVzaCh0YXJnZXRSb29tT2JqKTtcclxuICAgIH1cclxuXHJcbiAgICAvL0pvaW4gdGhlIHJvb21cclxuICAgIHRhcmdldFJvb21PYmoudXNlcnMucHVzaCh7XHJcbiAgICAgIHNvY2tldElkOiBzb2NrZXQuaWQsXHJcbiAgICAgIFxyXG4gICAgfSk7XHJcbiAgICArK3RhcmdldFJvb21PYmouY3VycmVudE51bTtcclxuXHJcbiAgICBzb2NrZXQuam9pbihyb29tTmFtZSk7XHJcbiAgICBzb2NrZXQuZW1pdChcImFjY2VwdF9qb2luXCIsIHRhcmdldFJvb21PYmoudXNlcnMpO1xyXG4gIH0pO1xyXG5cclxuICBzb2NrZXQub24oXCJvZmZlclwiLCAob2ZmZXIsIHJlbW90ZVNvY2tldElkKSA9PiB7XHJcbiAgICBzb2NrZXQudG8ocmVtb3RlU29ja2V0SWQpLmVtaXQoXCJvZmZlclwiLCBvZmZlciwgc29ja2V0LmlkKTtcclxuICB9KTtcclxuXHJcbiAgc29ja2V0Lm9uKFwiYW5zd2VyXCIsIChhbnN3ZXIsIHJlbW90ZVNvY2tldElkKSA9PiB7XHJcbiAgICBzb2NrZXQudG8ocmVtb3RlU29ja2V0SWQpLmVtaXQoXCJhbnN3ZXJcIiwgYW5zd2VyLCBzb2NrZXQuaWQpO1xyXG4gIH0pO1xyXG5cclxuICBzb2NrZXQub24oXCJpY2VcIiwgKGljZSwgcmVtb3RlU29ja2V0SWQpID0+IHtcclxuICAgIHNvY2tldC50byhyZW1vdGVTb2NrZXRJZCkuZW1pdChcImljZVwiLCBpY2UsIHNvY2tldC5pZCk7XHJcbiAgfSk7XHJcblxyXG4gIHNvY2tldC5vbihcImNoYXRcIiwgKG1lc3NhZ2UsIHJvb21OYW1lKSA9PiB7XHJcbiAgICBzb2NrZXQudG8ocm9vbU5hbWUpLmVtaXQoXCJjaGF0XCIsIG1lc3NhZ2UpO1xyXG4gIH0pO1xyXG5cclxuICBzb2NrZXQub24oXCJkaXNjb25uZWN0aW5nXCIsICgpID0+IHtcclxuICAgIHNvY2tldC50byhteVJvb21OYW1lKS5lbWl0KFwibGVhdmVfcm9vbVwiLCBzb2NrZXQuaWQpO1xyXG5cclxuICAgIGxldCBpc1Jvb21FbXB0eSA9IGZhbHNlO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByb29tT2JqQXJyLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgIGlmIChyb29tT2JqQXJyW2ldLnJvb21OYW1lID09PSBteVJvb21OYW1lKSB7XHJcbiAgICAgICAgY29uc3QgbmV3VXNlcnMgPSByb29tT2JqQXJyW2ldLnVzZXJzLmZpbHRlcihcclxuICAgICAgICAgICh1c2VyKSA9PiB1c2VyLnNvY2tldElkICE9IHNvY2tldC5pZFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgcm9vbU9iakFycltpXS51c2VycyA9IG5ld1VzZXJzO1xyXG4gICAgICAgIC0tcm9vbU9iakFycltpXS5jdXJyZW50TnVtO1xyXG5cclxuICAgICAgICBpZiAocm9vbU9iakFycltpXS5jdXJyZW50TnVtID09IDApIHtcclxuICAgICAgICAgIGlzUm9vbUVtcHR5ID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBEZWxldGUgcm9vbVxyXG4gICAgaWYgKGlzUm9vbUVtcHR5KSB7XHJcbiAgICAgIGNvbnN0IG5ld1Jvb21PYmpBcnIgPSByb29tT2JqQXJyLmZpbHRlcihcclxuICAgICAgICAocm9vbU9iaikgPT4gcm9vbU9iai5jdXJyZW50TnVtICE9IDBcclxuICAgICAgKTtcclxuICAgICAgcm9vbU9iakFyciA9IG5ld1Jvb21PYmpBcnI7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuY29uc3QgaGFuZGxlTGlzdGVuID0gKCkgPT4gY29uc29sZS5sb2coYExpc3RlbmluZyBvbiBodHRwOi8vbG9jYWxob3N0OjQwMDBgKTtcclxuaHR0cFNlcnZlci5saXN0ZW4oNDAwMCwgaGFuZGxlTGlzdGVuKTtcclxuIl0sIm1hcHBpbmdzIjoiOztBQUFBLElBQUFBLEtBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLE9BQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLFFBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFHLEtBQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTtBQUF3QixTQUFBRCx1QkFBQUssR0FBQSxXQUFBQSxHQUFBLElBQUFBLEdBQUEsQ0FBQUMsVUFBQSxHQUFBRCxHQUFBLGdCQUFBQSxHQUFBO0FBQUM7O0FBSXpCLElBQU1FLElBQUksR0FBR04sT0FBTyxDQUFDLE1BQU0sQ0FBQztBQUM1QixJQUFNTyxHQUFHLEdBQUcsSUFBQUMsbUJBQU8sRUFBQyxDQUFDOztBQUVwQjtBQUNEO0FBQ0E7O0FBRUFELEdBQUcsQ0FBQ0UsR0FBRyxDQUFDRCxtQkFBTyxVQUFPLENBQUNGLElBQUksQ0FBQ0ksSUFBSSxDQUFDQyxTQUFTLEVBQUUsZUFBZSxDQUFDLENBQUMsQ0FBQzs7QUFFOUQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUFKLEdBQUcsQ0FBQ0ssR0FBRyxDQUFDLEdBQUcsRUFBRSxVQUFDQyxHQUFHLEVBQUVDLEdBQUcsRUFBSztFQUN6QkEsR0FBRyxDQUFDQyxRQUFRLENBQUNULElBQUksQ0FBQ0ksSUFBSSxDQUFDQyxTQUFTLEdBQUcsbUJBQW1CLENBQUMsQ0FBQztBQUMxRCxDQUFDLENBQUM7QUFHRixJQUFNSyxVQUFVLEdBQUdDLGdCQUFJLENBQUNDLFlBQVksQ0FBQ1gsR0FBRyxDQUFDO0FBQ3pDLElBQU1ZLFFBQVEsR0FBRyxJQUFBQyxrQkFBUSxFQUFDSixVQUFVLENBQUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztB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","map":{"version":3,"names":["_http","_interopRequireDefault","require","_socket","_express","_cors","obj","__esModule","path","app","express","use","join","__dirname","get","req","res","sendFile","httpServer","http","createServer","wsServer","SocketIO","roomObjArr","MAXIMUM","on","socket","myRoomName","roomName","isRoomExist","targetRoomObj","i","length","currentNum","emit","users","push","socketId","id","offer","remoteSocketId","to","answer","ice","message","isRoomEmpty","newUsers","filter","user","newRoomObjArr","roomObj","handleListen","console","log","listen"],"sourceRoot":"C:\\Spring\\straight-blue-wave\\node-server\\src\\","sources":["server.js"],"sourcesContent":["import http from \"http\";\r\nimport SocketIO from \"socket.io\";\r\nimport express from \"express\";\r\nimport cors from \"cors\"; // 추가\r\n\r\n\r\n\r\nconst path = require('path');\r\nconst app = express();\r\n\r\n //app.use(cors({\r\n// origin: 'http://192.168.0.79:8002'\r\n// }));\r\n\r\napp.use(express.static(path.join(__dirname, \"/client/build\")));\r\n\r\n// app.set(\"view engine\", \"pug\");\r\n// app.set(\"views\", __dirname + \"/views\");\r\n// app.get(\"/\", (_, res) => res.render(\"home\"));\r\n// app.get(\"/*\", (_, res) => res.redirect(\"/\"));\r\n\r\napp.get(\"*\", (req, res) => {\r\n  res.sendFile(path.join(__dirname + '/build/index.html'));\r\n})\r\n\r\n\r\nconst httpServer = http.createServer(app);\r\nconst wsServer = SocketIO(httpServer);\r\n// const wsServer = SocketIO(httpServer, {\r\n//   cors: {\r\n//     origin: [\"http://localhost:3000\", \"http://172.26.20.111:3000\"], // 클라이언트 도메인을 허용합니다.\r\n//     methods: [\"GET\", \"POST\"],\r\n//   },\r\n// });\r\n\r\nlet roomObjArr = [\r\n  // {\r\n  //   roomName,\r\n  //   currentNum,\r\n  //   users: [\r\n  //     {\r\n  //       socketId,\r\n  //       nickname,\r\n  //     },\r\n  //   ],\r\n  // },\r\n];\r\nconst MAXIMUM = 5;\r\n\r\nwsServer.on(\"connection\", (socket) => {\r\n  let myRoomName = null;\r\n  // let myNickname = null;\r\n\r\n  socket.on(\"join_room\", (roomName) => {\r\n    myRoomName = roomName;\r\n    // myNickname = nickname;\r\n\r\n    let isRoomExist = false;\r\n    let targetRoomObj = null;\r\n\r\n    // forEach를 사용하지 않는 이유: callback함수를 사용하기 때문에 return이 효용없음.\r\n    for (let i = 0; i < roomObjArr.length; ++i) {\r\n      if (roomObjArr[i].roomName === roomName) {\r\n        // Reject join the room\r\n        if (roomObjArr[i].currentNum >= MAXIMUM) {\r\n          socket.emit(\"reject_join\");\r\n          return;\r\n        }\r\n\r\n        isRoomExist = true;\r\n        targetRoomObj = roomObjArr[i];\r\n        break;\r\n      }\r\n    }\r\n\r\n    // Create room\r\n    if (!isRoomExist) {\r\n      targetRoomObj = {\r\n        roomName,\r\n        currentNum: 0,\r\n        users: [],\r\n      };\r\n      roomObjArr.push(targetRoomObj);\r\n    }\r\n\r\n    //Join the room\r\n    targetRoomObj.users.push({\r\n      socketId: socket.id,\r\n      \r\n    });\r\n    ++targetRoomObj.currentNum;\r\n\r\n    socket.join(roomName);\r\n    socket.emit(\"accept_join\", targetRoomObj.users);\r\n  });\r\n\r\n  socket.on(\"offer\", (offer, remoteSocketId) => {\r\n    socket.to(remoteSocketId).emit(\"offer\", offer, socket.id);\r\n  });\r\n\r\n  socket.on(\"answer\", (answer, remoteSocketId) => {\r\n    socket.to(remoteSocketId).emit(\"answer\", answer, socket.id);\r\n  });\r\n\r\n  socket.on(\"ice\", (ice, remoteSocketId) => {\r\n    socket.to(remoteSocketId).emit(\"ice\", ice, socket.id);\r\n  });\r\n\r\n  socket.on(\"chat\", (message, roomName) => {\r\n    socket.to(roomName).emit(\"chat\", message);\r\n  });\r\n\r\n  socket.on(\"disconnecting\", () => {\r\n    socket.to(myRoomName).emit(\"leave_room\", socket.id);\r\n\r\n    let isRoomEmpty = false;\r\n    for (let i = 0; i < roomObjArr.length; ++i) {\r\n      if (roomObjArr[i].roomName === myRoomName) {\r\n        const newUsers = roomObjArr[i].users.filter(\r\n          (user) => user.socketId != socket.id\r\n        );\r\n        roomObjArr[i].users = newUsers;\r\n        --roomObjArr[i].currentNum;\r\n\r\n        if (roomObjArr[i].currentNum == 0) {\r\n          isRoomEmpty = true;\r\n        }\r\n      }\r\n    }\r\n\r\n    // Delete room\r\n    if (isRoomEmpty) {\r\n      const newRoomObjArr = roomObjArr.filter(\r\n        (roomObj) => roomObj.currentNum != 0\r\n      );\r\n      roomObjArr = newRoomObjArr;\r\n    }\r\n  });\r\n});\r\n\r\nconst handleListen = () => console.log(`Listening on http://localhost:4000`);\r\nhttpServer.listen(4000, handleListen);\r\n"],"mappings":"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"}},"mtime":1683153414770}}