{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ban-yeongseo/Projects/straight-blue-wave/react-server/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/ban-yeongseo/Projects/straight-blue-wave/react-server/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/ban-yeongseo/Projects/straight-blue-wave/react-server/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Container}from\"react-bootstrap\";import React,{useRef,useState}from'react';import io from'socket.io-client';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function MainPage(props){var socket=io();var myFaceRef=useRef(null);var muteRef=useRef(null);var cameraRef=useRef(null);var camerasRef=useRef(null);var callRef=useRef(null);var welcomeRef=useRef(null);var welcomeFormRef=useRef(null);// const peerFaceRef = useRef(null);\nvar _useState=useState(true),_useState2=_slicedToArray(_useState,2),hidden=_useState2[0],setHidden=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),welHidden=_useState4[0],setWelHidden=_useState4[1];// 추가\nvar streamBoxRef=useRef(null);var streamsRef=useRef(null);var myStreamRef=useRef(null);var userNickNameRef=useRef(null);var controllersRef=useRef(null);var buttonsRef=useRef(null);var chatRoomRef=useRef(null);var chatBoxRef=useRef(null);var chatFormRef=useRef(null);var roomNameRef=useRef(null);var nickNameRef=useRef(null);// const HIDDEN = \"hidden\";\nvar myPeerConnection=null;var myStream;var muted=false;var cameraOff=false;var roomName=\"\";var nickname=\"\";var peopleInRoom=1;var pcObj={};var peerConnectionObjArr=[];function getCameras(){return _getCameras.apply(this,arguments);}function _getCameras(){_getCameras=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(){var devices,cameras,currentCamera;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return navigator.mediaDevices.enumerateDevices();case 3:devices=_context5.sent;cameras=devices.filter(function(device){return device.kind===\"videoinput\";});currentCamera=myStream.getVideoTracks();cameras.forEach(function(camera){var option=document.createElement(\"option\");option.value=camera.deviceId;option.innerText=camera.label;if(currentCamera.label==camera.label){option.selected=true;}camerasRef.current.appendChild(option);});_context5.next=12;break;case 9:_context5.prev=9;_context5.t0=_context5[\"catch\"](0);console.log(_context5.t0);case 12:case\"end\":return _context5.stop();}},_callee5,null,[[0,9]]);}));return _getCameras.apply(this,arguments);}function getMedia(_x){return _getMedia.apply(this,arguments);}function _getMedia(){_getMedia=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(deviceId){var initialConstraints,cameraConstraints;return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1)switch(_context6.prev=_context6.next){case 0:initialConstraints={audio:true,video:{facingMode:\"user\"}};cameraConstraints={audio:true,video:{deviceId:{exact:deviceId}}};_context6.prev=2;_context6.next=5;return navigator.mediaDevices.getUserMedia(deviceId?cameraConstraints:initialConstraints);case 5:myStream=_context6.sent;// stream을 mute하는 것이 아니라 HTML video element를 mute한다.\nmyFaceRef.current.srcObject=myStream;myFaceRef.current.muted=true;if(deviceId){_context6.next=12;break;}// mute default\nmyStream//\n.getAudioTracks().forEach(function(track){return track.enabled=false;});_context6.next=12;return getCameras();case 12:_context6.next=17;break;case 14:_context6.prev=14;_context6.t0=_context6[\"catch\"](2);console.log(_context6.t0);case 17:case\"end\":return _context6.stop();}},_callee6,null,[[2,14]]);}));return _getMedia.apply(this,arguments);}function handleMuteClick(){myStream//\n.getAudioTracks().forEach(function(track){return track.enabled=!track.enabled;});if(muted){// unMuteIcon.classList.remove(HIDDEN_CN);\n// muteIcon.classList.add(HIDDEN_CN);\nmuted=false;}else{// muteIcon.classList.remove(HIDDEN_CN);\n// unMuteIcon.classList.add(HIDDEN_CN);\nmuted=true;}}function handleCameraClick(){myStream//\n.getVideoTracks().forEach(function(track){return track.enabled=!track.enabled;});if(cameraOff){// cameraIcon.classList.remove(HIDDEN_CN);\n// unCameraIcon.classList.add(HIDDEN_CN);\ncameraOff=false;}else{// unCameraIcon.classList.remove(HIDDEN_CN);\n// cameraIcon.classList.add(HIDDEN_CN);\ncameraOff=true;}}function handleCameraChange(){return _handleCameraChange.apply(this,arguments);}/////////////////////////////////// prototype\n// Screen Sharing\n// let captureStream = null;\n// async function startCapture() {\n//   try {\n//     captureStream = await navigator.mediaDevices.getDisplayMedia({\n//       video: true,\n//       audio: true,\n//     });\n//     const screenVideo = document.querySelector(\"#screen\");\n//     screenVideo.srcObject = captureStream;\n//   } catch (error) {\n//     console.error(error);\n//   }\n// }\n// Welcome Form (choose room)\n// call.classList.add(HIDDEN_CN);\n// welcome.hidden = true;\nfunction _handleCameraChange(){_handleCameraChange=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(){var newVideoTrack;return _regeneratorRuntime().wrap(function _callee7$(_context7){while(1)switch(_context7.prev=_context7.next){case 0:_context7.prev=0;_context7.next=3;return getMedia(camerasRef.current.value);case 3:if(peerConnectionObjArr.length>0){newVideoTrack=myStream.getVideoTracks()[0];peerConnectionObjArr.forEach(function(peerConnectionObj){var peerConnection=peerConnectionObj.connection;var peerVideoSender=peerConnection.getSenders().find(function(sender){return sender.track.kind==\"video\";});peerVideoSender.replaceTrack(newVideoTrack);});}_context7.next=9;break;case 6:_context7.prev=6;_context7.t0=_context7[\"catch\"](0);console.log(_context7.t0);case 9:case\"end\":return _context7.stop();}},_callee7,null,[[0,6]]);}));return _handleCameraChange.apply(this,arguments);}function initCall(){return _initCall.apply(this,arguments);}function _initCall(){_initCall=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8(){return _regeneratorRuntime().wrap(function _callee8$(_context8){while(1)switch(_context8.prev=_context8.next){case 0:setWelHidden(true);// welcome.hidden = true;\n// call.classList.remove(HIDDEN_CN);\n_context8.next=3;return getMedia();case 3:case\"end\":return _context8.stop();}},_callee8);}));return _initCall.apply(this,arguments);}function handleWelcomeSubmit(_x2){return _handleWelcomeSubmit.apply(this,arguments);}// Chat Form\nfunction _handleWelcomeSubmit(){_handleWelcomeSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee9(event){var welcomeRoomName,welcomeNickname,nicknameContainer;return _regeneratorRuntime().wrap(function _callee9$(_context9){while(1)switch(_context9.prev=_context9.next){case 0:event.preventDefault();if(socket.disconnected){socket.connect();}welcomeRoomName=roomNameRef.current;welcomeNickname=nickNameRef.current;nicknameContainer=userNickNameRef.current;roomName=welcomeRoomName.value;welcomeRoomName.value=\"\";nickname=welcomeNickname.value;welcomeNickname.value=\"\";nicknameContainer.innerText=nickname;socket.emit(\"join_room\",roomName,nickname);case 11:case\"end\":return _context9.stop();}},_callee9);}));return _handleWelcomeSubmit.apply(this,arguments);}var chatForm=chatFormRef.current;var chatBox=chatBoxRef.current;var MYCHAT_CN=\"myChat\";var NOTICE_CN=\"noticeChat\";chatForm.addEventListener(\"submit\",handleChatSubmit);function handleChatSubmit(event){event.preventDefault();var chatInput=chatForm.querySelector(\"input\");var message=chatInput.value;chatInput.value=\"\";socket.emit(\"chat\",\"\".concat(nickname,\": \").concat(message),roomName);writeChat(\"You: \".concat(message),MYCHAT_CN);}function writeChat(message){var className=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var li=document.createElement(\"li\");var span=document.createElement(\"span\");span.innerText=message;li.appendChild(span);// li.classList.add(className);\nchatBox.prepend(li);}// Leave Room\nvar leaveBtn=document.querySelector(\"#leave\");function leaveRoom(){socket.disconnect();// call.classList.add(HIDDEN_CN);\nsetWelHidden(false);peerConnectionObjArr=[];peopleInRoom=1;nickname=\"\";myStream.getTracks().forEach(function(track){return track.stop();});var nicknameContainer=document.querySelector(\"#userNickname\");nicknameContainer.innerText=\"\";myFaceRef.current.srcObject=null;clearAllVideos();clearAllChat();}function removeVideo(leavedSocketId){var streams=streamsRef.current;var streamArr=streams.querySelectorAll(\"div\");streamArr.forEach(function(streamElement){if(streamElement.id===leavedSocketId){streams.removeChild(streamElement);}});}function clearAllVideos(){var streams=streamsRef.current;var streamArr=streams.querySelectorAll(\"div\");streamArr.forEach(function(streamElement){if(streamElement.id!=\"myStream\"){streams.removeChild(streamElement);}});}function clearAllChat(){var chatArr=chatBox.querySelectorAll(\"li\");chatArr.forEach(function(chat){return chatBox.removeChild(chat);});}leaveBtn.addEventListener(\"click\",leaveRoom);// Modal code\nvar modal=document.querySelector(\".modal\");var modalText=modal.querySelector(\".modal__text\");var modalBtn=modal.querySelector(\".modal__btn\");function paintModal(text){modalText.innerText=text;// modal.classList.remove(HIDDEN_CN);\nmodal.addEventListener(\"click\",removeModal);modalBtn.addEventListener(\"click\",removeModal);document.addEventListener(\"keydown\",handleKeydown);}function removeModal(){// modal.classList.add(HIDDEN_CN);\nmodalText.innerText=\"\";}function handleKeydown(event){if(event.code===\"Escape\"||event.code===\"Enter\"){removeModal();}}// Socket code\nsocket.on(\"reject_join\",function(){// Paint modal\npaintModal(\"Sorry, The room is already full.\");// Erase names\nvar nicknameContainer=userNickNameRef.current;nicknameContainer.innerText=\"\";roomName=\"\";nickname=\"\";});socket.on(\"accept_join\",/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(userObjArr){var length,i,newPC,offer;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return initCall();case 2:length=userObjArr.length;if(!(length===1)){_context.next=5;break;}return _context.abrupt(\"return\");case 5:writeChat(\"Notice!\",NOTICE_CN);i=0;case 7:if(!(i<length-1)){_context.next=25;break;}_context.prev=8;newPC=createConnection(userObjArr[i].socketId,userObjArr[i].nickname);_context.next=12;return newPC.createOffer();case 12:offer=_context.sent;_context.next=15;return newPC.setLocalDescription(offer);case 15:socket.emit(\"offer\",offer,userObjArr[i].socketId,nickname);writeChat(\"__\".concat(userObjArr[i].nickname,\"__\"),NOTICE_CN);_context.next=22;break;case 19:_context.prev=19;_context.t0=_context[\"catch\"](8);console.error(_context.t0);case 22:++i;_context.next=7;break;case 25:writeChat(\"is in the room.\",NOTICE_CN);case 26:case\"end\":return _context.stop();}},_callee,null,[[8,19]]);}));return function(_x3){return _ref.apply(this,arguments);};}());socket.on(\"offer\",/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(offer,remoteSocketId,remoteNickname){var newPC,answer;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;newPC=createConnection(remoteSocketId,remoteNickname);_context2.next=4;return newPC.setRemoteDescription(offer);case 4:_context2.next=6;return newPC.createAnswer();case 6:answer=_context2.sent;_context2.next=9;return newPC.setLocalDescription(answer);case 9:socket.emit(\"answer\",answer,remoteSocketId);writeChat(\"notice! __\".concat(remoteNickname,\"__ joined the room\"),NOTICE_CN);_context2.next=16;break;case 13:_context2.prev=13;_context2.t0=_context2[\"catch\"](0);console.error(_context2.t0);case 16:case\"end\":return _context2.stop();}},_callee2,null,[[0,13]]);}));return function(_x4,_x5,_x6){return _ref2.apply(this,arguments);};}());socket.on(\"answer\",/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(answer,remoteSocketId){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.next=2;return pcObj[remoteSocketId].setRemoteDescription(answer);case 2:case\"end\":return _context3.stop();}},_callee3);}));return function(_x7,_x8){return _ref3.apply(this,arguments);};}());socket.on(\"ice\",/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(ice,remoteSocketId){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:_context4.next=2;return pcObj[remoteSocketId].addIceCandidate(ice);case 2:case\"end\":return _context4.stop();}},_callee4);}));return function(_x9,_x10){return _ref4.apply(this,arguments);};}());socket.on(\"chat\",function(message){writeChat(message);});socket.on(\"leave_room\",function(leavedSocketId,nickname){removeVideo(leavedSocketId);writeChat(\"notice! \".concat(nickname,\" leaved the room.\"),NOTICE_CN);--peopleInRoom;sortStreams();});// RTC code\nfunction createConnection(remoteSocketId,remoteNickname){var myPeerConnection=new RTCPeerConnection({iceServers:[{urls:[\"stun:stun.l.google.com:19302\",\"stun:stun1.l.google.com:19302\",\"stun:stun2.l.google.com:19302\",\"stun:stun3.l.google.com:19302\",\"stun:stun4.l.google.com:19302\"]}]});myPeerConnection.addEventListener(\"icecandidate\",function(event){handleIce(event,remoteSocketId);});myPeerConnection.addEventListener(\"addstream\",function(event){handleAddStream(event,remoteSocketId,remoteNickname);});// myPeerConnection.addEventListener(\n//   \"iceconnectionstatechange\",\n//   handleConnectionStateChange\n// );\nmyStream//\n.getTracks().forEach(function(track){return myPeerConnection.addTrack(track,myStream);});pcObj[remoteSocketId]=myPeerConnection;++peopleInRoom;sortStreams();return myPeerConnection;}function handleIce(event,remoteSocketId){if(event.candidate){socket.emit(\"ice\",event.candidate,remoteSocketId);}}function handleAddStream(event,remoteSocketId,remoteNickname){var peerStream=event.stream;paintPeerFace(peerStream,remoteSocketId,remoteNickname);}function paintPeerFace(peerStream,id,remoteNickname){var streams=streamsRef.current;var div=document.createElement(\"div\");div.id=id;var video=document.createElement(\"video\");video.autoplay=true;video.playsInline=true;video.width=\"400\";video.height=\"400\";video.srcObject=peerStream;var nicknameContainer=document.createElement(\"h3\");nicknameContainer.id=\"userNickname\";nicknameContainer.innerText=remoteNickname;div.appendChild(video);div.appendChild(nicknameContainer);streams.appendChild(div);sortStreams();}function sortStreams(){var streams=streamsRef.current;var streamArr=streams.querySelectorAll(\"div\");streamArr.forEach(function(stream){return stream.className=\"people\".concat(peopleInRoom);});}/*\nfunction handleConnectionStateChange(event) {\n  console.log(`${pcObjArr.length - 1} CS: ${event.target.connectionState}`);\n  console.log(`${pcObjArr.length - 1} ICS: ${event.target.iceConnectionState}`);\n\n  if (event.target.iceConnectionState === \"disconnected\") {\n  }\n}\n*/return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\uC601\\uC0C1\\uD1B5\\uD654\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"video\",children:[/*#__PURE__*/_jsx(\"div\",{id:\"welcome\",ref:welcomeRef,style:{display:welHidden?\"none\":\"block\"},children:/*#__PURE__*/_jsxs(\"form\",{ref:welcomeFormRef,children:[/*#__PURE__*/_jsx(\"input\",{ref:roomNameRef,placeholder:\"room name\",required:true,type:\"text\"}),/*#__PURE__*/_jsx(\"input\",{ref:nickNameRef,placeholder:\"nick name\",type:\"text\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleWelcomeSubmit,children:\"Enter room\"})]})}),/*#__PURE__*/_jsxs(\"div\",{id:\"call\",ref:callRef,style:{display:hidden?\"none\":\"block\"},children:[/*#__PURE__*/_jsxs(\"div\",{ref:streamBoxRef,children:[/*#__PURE__*/_jsx(\"div\",{ref:streamsRef,children:/*#__PURE__*/_jsxs(\"div\",{ref:myStreamRef,className:\"people1\",children:[/*#__PURE__*/_jsx(\"video\",{id:\"myFace\",ref:myFaceRef,autoPlay:true,playsInline:true,width:\"400\",height:\"400\"}),/*#__PURE__*/_jsx(\"h3\",{ref:userNickNameRef,children:\"\\\"\"})]})}),/*#__PURE__*/_jsxs(\"div\",{ref:controllersRef,children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"select\",{id:\"cameras\",ref:camerasRef,onChange:handleCameraChange})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{ref:buttonsRef,children:[/*#__PURE__*/_jsx(\"button\",{id:\"mute\",ref:muteRef,onClick:handleMuteClick,children:\"Mute\"}),/*#__PURE__*/_jsx(\"button\",{id:\"camera\",ref:cameraRef,onClick:handleCameraClick,children:\"Turn Camera Off\"})]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{children:\"Leave\"})})]})]}),/*#__PURE__*/_jsx(\"div\",{ref:chatRoomRef,children:/*#__PURE__*/_jsx(\"ul\",{ref:chatBoxRef,children:/*#__PURE__*/_jsxs(\"form\",{ref:chatFormRef,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Write your chat\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleChatSubmit,children:\"Send\"})]})})})]})]})]});}export default MainPage;","map":{"version":3,"names":["Container","React","useRef","useState","io","jsx","_jsx","jsxs","_jsxs","MainPage","props","socket","myFaceRef","muteRef","cameraRef","camerasRef","callRef","welcomeRef","welcomeFormRef","_useState","_useState2","_slicedToArray","hidden","setHidden","_useState3","_useState4","welHidden","setWelHidden","streamBoxRef","streamsRef","myStreamRef","userNickNameRef","controllersRef","buttonsRef","chatRoomRef","chatBoxRef","chatFormRef","roomNameRef","nickNameRef","myPeerConnection","myStream","muted","cameraOff","roomName","nickname","peopleInRoom","pcObj","peerConnectionObjArr","getCameras","_getCameras","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee5","devices","cameras","currentCamera","wrap","_callee5$","_context5","prev","next","navigator","mediaDevices","enumerateDevices","sent","filter","device","kind","getVideoTracks","forEach","camera","option","document","createElement","value","deviceId","innerText","label","selected","current","appendChild","t0","console","log","stop","getMedia","_x","_getMedia","_callee6","initialConstraints","cameraConstraints","_callee6$","_context6","audio","video","facingMode","exact","getUserMedia","srcObject","getAudioTracks","track","enabled","handleMuteClick","handleCameraClick","handleCameraChange","_handleCameraChange","_callee7","newVideoTrack","_callee7$","_context7","length","peerConnectionObj","peerConnection","connection","peerVideoSender","getSenders","find","sender","replaceTrack","initCall","_initCall","_callee8","_callee8$","_context8","handleWelcomeSubmit","_x2","_handleWelcomeSubmit","_callee9","event","welcomeRoomName","welcomeNickname","nicknameContainer","_callee9$","_context9","preventDefault","disconnected","connect","emit","chatForm","chatBox","MYCHAT_CN","NOTICE_CN","addEventListener","handleChatSubmit","chatInput","querySelector","message","concat","writeChat","className","undefined","li","span","prepend","leaveBtn","leaveRoom","disconnect","getTracks","clearAllVideos","clearAllChat","removeVideo","leavedSocketId","streams","streamArr","querySelectorAll","streamElement","id","removeChild","chatArr","chat","modal","modalText","modalBtn","paintModal","text","removeModal","handleKeydown","code","on","_ref","_callee","userObjArr","i","newPC","offer","_callee$","_context","abrupt","createConnection","socketId","createOffer","setLocalDescription","error","_x3","_ref2","_callee2","remoteSocketId","remoteNickname","answer","_callee2$","_context2","setRemoteDescription","createAnswer","_x4","_x5","_x6","_ref3","_callee3","_callee3$","_context3","_x7","_x8","_ref4","_callee4","ice","_callee4$","_context4","addIceCandidate","_x9","_x10","sortStreams","RTCPeerConnection","iceServers","urls","handleIce","handleAddStream","addTrack","candidate","peerStream","stream","paintPeerFace","div","autoplay","playsInline","width","height","children","ref","style","display","placeholder","required","type","onClick","autoPlay","onChange"],"sources":["/Users/ban-yeongseo/Projects/straight-blue-wave/react-server/src/pages/MainPage.js"],"sourcesContent":["import {Container} from \"react-bootstrap\";\nimport React, {useRef, useState} from 'react';\nimport io from 'socket.io-client';\n\n\nfunction MainPage(props) {\n\n\tconst socket = io();\n  const myFaceRef = useRef(null);\n  const muteRef = useRef(null);\n  const cameraRef = useRef(null);\n  const camerasRef = useRef(null);\n  const callRef = useRef(null);\n  const welcomeRef = useRef(null);\n  const welcomeFormRef = useRef(null);\n  // const peerFaceRef = useRef(null);\n  const [hidden, setHidden] = useState(true);\n  const [welHidden, setWelHidden] = useState(false);\n\n  // 추가\n  const streamBoxRef = useRef(null);\n  const streamsRef = useRef(null);\n  const myStreamRef = useRef(null);\n  const userNickNameRef = useRef(null);\n  const controllersRef = useRef(null);\n  const buttonsRef = useRef(null);\n  const chatRoomRef = useRef(null);\n  const chatBoxRef = useRef(null);\n  const chatFormRef = useRef(null);\n  const roomNameRef = useRef(null);\n  const nickNameRef = useRef(null);\n\n  // const HIDDEN = \"hidden\";\n\n\n\n  let myPeerConnection = null;\n  let myStream;\n  let muted = false;\n  let cameraOff = false;\n  let roomName = \"\";\n  let nickname = \"\";\n  \n  let peopleInRoom = 1;\n  let pcObj = {};\n  let peerConnectionObjArr = [];\n  \n  \n\nasync function getCameras() {\n  try {\n    const devices = await navigator.mediaDevices.enumerateDevices();\n    const cameras = devices.filter((device) => device.kind === \"videoinput\");\n    const currentCamera = myStream.getVideoTracks();\n    cameras.forEach((camera) => {\n      const option = document.createElement(\"option\");\n      option.value = camera.deviceId;\n      option.innerText = camera.label;\n\n      if (currentCamera.label == camera.label) {\n        option.selected = true;\n      }\n\n      camerasRef.current.appendChild(option);\n    });\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nasync function getMedia(deviceId) {\n  const initialConstraints = {\n    audio: true,\n    video: { facingMode: \"user\" },\n  };\n  const cameraConstraints = {\n    audio: true,\n    video: { deviceId: { exact: deviceId } },\n  };\n\n  try {\n    myStream = await navigator.mediaDevices.getUserMedia(\n      deviceId ? cameraConstraints : initialConstraints\n    );\n\n    // stream을 mute하는 것이 아니라 HTML video element를 mute한다.\n    myFaceRef.current.srcObject = myStream;\n    myFaceRef.current.muted = true;\n\n    if (!deviceId) {\n      // mute default\n      myStream //\n        .getAudioTracks()\n        .forEach((track) => (track.enabled = false));\n\n      await getCameras();\n    }\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nfunction handleMuteClick() {\n  myStream //\n    .getAudioTracks()\n    .forEach((track) => (track.enabled = !track.enabled));\n  if (muted) {\n    // unMuteIcon.classList.remove(HIDDEN_CN);\n    // muteIcon.classList.add(HIDDEN_CN);\n    muted = false;\n  } else {\n    // muteIcon.classList.remove(HIDDEN_CN);\n    // unMuteIcon.classList.add(HIDDEN_CN);\n    muted = true;\n  }\n}\n\nfunction handleCameraClick() {\n  myStream //\n    .getVideoTracks()\n    .forEach((track) => (track.enabled = !track.enabled));\n  if (cameraOff) {\n    // cameraIcon.classList.remove(HIDDEN_CN);\n    // unCameraIcon.classList.add(HIDDEN_CN);\n    cameraOff = false;\n  } else {\n    // unCameraIcon.classList.remove(HIDDEN_CN);\n    // cameraIcon.classList.add(HIDDEN_CN);\n    cameraOff = true;\n  }\n}\n\nasync function handleCameraChange() {\n  try {\n    await getMedia(camerasRef.current.value);\n    if (peerConnectionObjArr.length > 0) {\n      const newVideoTrack = myStream.getVideoTracks()[0];\n      peerConnectionObjArr.forEach((peerConnectionObj) => {\n        const peerConnection = peerConnectionObj.connection;\n        const peerVideoSender = peerConnection\n          .getSenders()\n          .find((sender) => sender.track.kind == \"video\");\n        peerVideoSender.replaceTrack(newVideoTrack);\n      });\n    }\n  } catch (error) {\n    console.log(error);\n  }\n}\n\n\n/////////////////////////////////// prototype\n// Screen Sharing\n\n// let captureStream = null;\n\n// async function startCapture() {\n//   try {\n//     captureStream = await navigator.mediaDevices.getDisplayMedia({\n//       video: true,\n//       audio: true,\n//     });\n\n//     const screenVideo = document.querySelector(\"#screen\");\n//     screenVideo.srcObject = captureStream;\n//   } catch (error) {\n//     console.error(error);\n//   }\n// }\n\n// Welcome Form (choose room)\n\n// call.classList.add(HIDDEN_CN);\n// welcome.hidden = true;\n\n\n\nasync function initCall() {\n  setWelHidden(true);\n  // welcome.hidden = true;\n  // call.classList.remove(HIDDEN_CN);\n  await getMedia();\n}\n\nasync function handleWelcomeSubmit(event) {\n  event.preventDefault();\n\n  if (socket.disconnected) {\n    socket.connect();\n  }\n\n  const welcomeRoomName = roomNameRef.current;\n  const welcomeNickname = nickNameRef.current\n  const nicknameContainer = userNickNameRef.current;\n  roomName = welcomeRoomName.value;\n  welcomeRoomName.value = \"\";\n  nickname = welcomeNickname.value;\n  welcomeNickname.value = \"\";\n  nicknameContainer.innerText = nickname;\n  socket.emit(\"join_room\", roomName, nickname);\n}\n\n\n\n// Chat Form\n\nconst chatForm = chatFormRef.current;\nconst chatBox = chatBoxRef.current;\n\nconst MYCHAT_CN = \"myChat\";\nconst NOTICE_CN = \"noticeChat\";\n\nchatForm.addEventListener(\"submit\", handleChatSubmit);\n\nfunction handleChatSubmit(event) {\n  event.preventDefault();\n  const chatInput = chatForm.querySelector(\"input\");\n  const message = chatInput.value;\n  chatInput.value = \"\";\n  socket.emit(\"chat\", `${nickname}: ${message}`, roomName);\n  writeChat(`You: ${message}`, MYCHAT_CN);\n}\n\nfunction writeChat(message, className = null) {\n  const li = document.createElement(\"li\");\n  const span = document.createElement(\"span\");\n  span.innerText = message;\n  li.appendChild(span);\n  // li.classList.add(className);\n  chatBox.prepend(li);\n}\n\n// Leave Room\n\nconst leaveBtn = document.querySelector(\"#leave\");\n\nfunction leaveRoom() {\n  socket.disconnect();\n\n  // call.classList.add(HIDDEN_CN);\n  setWelHidden(false);\n\n  peerConnectionObjArr = [];\n  peopleInRoom = 1;\n  nickname = \"\";\n\n  myStream.getTracks().forEach((track) => track.stop());\n  const nicknameContainer = document.querySelector(\"#userNickname\");\n  nicknameContainer.innerText = \"\";\n\n  myFaceRef.current.srcObject = null;\n  clearAllVideos();\n  clearAllChat();\n}\n\nfunction removeVideo(leavedSocketId) {\n  const streams = streamsRef.current;\n  const streamArr = streams.querySelectorAll(\"div\");\n  streamArr.forEach((streamElement) => {\n    if (streamElement.id === leavedSocketId) {\n      streams.removeChild(streamElement);\n    }\n  });\n}\n\nfunction clearAllVideos() {\n  const streams = streamsRef.current;\n  const streamArr = streams.querySelectorAll(\"div\");\n  streamArr.forEach((streamElement) => {\n    if (streamElement.id != \"myStream\") {\n      streams.removeChild(streamElement);\n    }\n  });\n}\n\nfunction clearAllChat() {\n  const chatArr = chatBox.querySelectorAll(\"li\");\n  chatArr.forEach((chat) => chatBox.removeChild(chat));\n}\n\nleaveBtn.addEventListener(\"click\", leaveRoom);\n\n// Modal code\n\nconst modal = document.querySelector(\".modal\");\nconst modalText = modal.querySelector(\".modal__text\");\nconst modalBtn = modal.querySelector(\".modal__btn\");\n\nfunction paintModal(text) {\n  modalText.innerText = text;\n  // modal.classList.remove(HIDDEN_CN);\n\n  modal.addEventListener(\"click\", removeModal);\n  modalBtn.addEventListener(\"click\", removeModal);\n  document.addEventListener(\"keydown\", handleKeydown);\n}\n\nfunction removeModal() {\n  // modal.classList.add(HIDDEN_CN);\n  modalText.innerText = \"\";\n}\n\nfunction handleKeydown(event) {\n  if (event.code === \"Escape\" || event.code === \"Enter\") {\n    removeModal();\n  }\n}\n\n// Socket code\n\nsocket.on(\"reject_join\", () => {\n  // Paint modal\n  paintModal(\"Sorry, The room is already full.\");\n\n  // Erase names\n  const nicknameContainer = userNickNameRef.current;\n  nicknameContainer.innerText = \"\";\n  roomName = \"\";\n  nickname = \"\";\n});\n\nsocket.on(\"accept_join\", async (userObjArr) => {\n  await initCall();\n\n  const length = userObjArr.length;\n  if (length === 1) {\n    return;\n  }\n\n  writeChat(\"Notice!\", NOTICE_CN);\n  for (let i = 0; i < length - 1; ++i) {\n    try {\n      const newPC = createConnection(\n        userObjArr[i].socketId,\n        userObjArr[i].nickname\n      );\n      const offer = await newPC.createOffer();\n      await newPC.setLocalDescription(offer);\n      socket.emit(\"offer\", offer, userObjArr[i].socketId, nickname);\n      writeChat(`__${userObjArr[i].nickname}__`, NOTICE_CN);\n    } catch (err) {\n      console.error(err);\n    }\n  }\n  writeChat(\"is in the room.\", NOTICE_CN);\n});\n\nsocket.on(\"offer\", async (offer, remoteSocketId, remoteNickname) => {\n  try {\n    const newPC = createConnection(remoteSocketId, remoteNickname);\n    await newPC.setRemoteDescription(offer);\n    const answer = await newPC.createAnswer();\n    await newPC.setLocalDescription(answer);\n    socket.emit(\"answer\", answer, remoteSocketId);\n    writeChat(`notice! __${remoteNickname}__ joined the room`, NOTICE_CN);\n  } catch (err) {\n    console.error(err);\n  }\n});\n\nsocket.on(\"answer\", async (answer, remoteSocketId) => {\n  await pcObj[remoteSocketId].setRemoteDescription(answer);\n});\n\nsocket.on(\"ice\", async (ice, remoteSocketId) => {\n  await pcObj[remoteSocketId].addIceCandidate(ice);\n});\n\nsocket.on(\"chat\", (message) => {\n  writeChat(message);\n});\n\nsocket.on(\"leave_room\", (leavedSocketId, nickname) => {\n  removeVideo(leavedSocketId);\n  writeChat(`notice! ${nickname} leaved the room.`, NOTICE_CN);\n  --peopleInRoom;\n  sortStreams();\n});\n\n// RTC code\n\nfunction createConnection(remoteSocketId, remoteNickname) {\n  const myPeerConnection = new RTCPeerConnection({\n    iceServers: [\n      {\n        urls: [\n          \"stun:stun.l.google.com:19302\",\n          \"stun:stun1.l.google.com:19302\",\n          \"stun:stun2.l.google.com:19302\",\n          \"stun:stun3.l.google.com:19302\",\n          \"stun:stun4.l.google.com:19302\",\n        ],\n      },\n    ],\n  });\n  myPeerConnection.addEventListener(\"icecandidate\", (event) => {\n    handleIce(event, remoteSocketId);\n  });\n  myPeerConnection.addEventListener(\"addstream\", (event) => {\n    handleAddStream(event, remoteSocketId, remoteNickname);\n  });\n  // myPeerConnection.addEventListener(\n  //   \"iceconnectionstatechange\",\n  //   handleConnectionStateChange\n  // );\n  myStream //\n    .getTracks()\n    .forEach((track) => myPeerConnection.addTrack(track, myStream));\n\n  pcObj[remoteSocketId] = myPeerConnection;\n\n  ++peopleInRoom;\n  sortStreams();\n  return myPeerConnection;\n}\n\nfunction handleIce(event, remoteSocketId) {\n  if (event.candidate) {\n    socket.emit(\"ice\", event.candidate, remoteSocketId);\n  }\n}\n\nfunction handleAddStream(event, remoteSocketId, remoteNickname) {\n  const peerStream = event.stream;\n  paintPeerFace(peerStream, remoteSocketId, remoteNickname);\n}\n\nfunction paintPeerFace(peerStream, id, remoteNickname) {\n  const streams = streamsRef.current;\n  const div = document.createElement(\"div\");\n  div.id = id;\n  const video = document.createElement(\"video\");\n  video.autoplay = true;\n  video.playsInline = true;\n  video.width = \"400\";\n  video.height = \"400\";\n  video.srcObject = peerStream;\n  const nicknameContainer = document.createElement(\"h3\");\n  nicknameContainer.id = \"userNickname\";\n  nicknameContainer.innerText = remoteNickname;\n\n  div.appendChild(video);\n  div.appendChild(nicknameContainer);\n  streams.appendChild(div);\n  sortStreams();\n}\n\nfunction sortStreams() {\n  const streams = streamsRef.current;\n  const streamArr = streams.querySelectorAll(\"div\");\n  streamArr.forEach((stream) => (stream.className = `people${peopleInRoom}`));\n}\n/*\nfunction handleConnectionStateChange(event) {\n  console.log(`${pcObjArr.length - 1} CS: ${event.target.connectionState}`);\n  console.log(`${pcObjArr.length - 1} ICS: ${event.target.iceConnectionState}`);\n\n  if (event.target.iceConnectionState === \"disconnected\") {\n  }\n}\n*/\n\n\n\treturn (\n\t\t<Container>\n\t\t\t<h1>영상통화</h1>\n\t\t\t<div className=\"video\">\n        \n            <div id=\"welcome\" ref={welcomeRef} \n                style={{display: welHidden ? \"none\" : \"block\"}}\n            >\n              <form ref={welcomeFormRef}>\n                <input ref={roomNameRef} placeholder=\"room name\" required type=\"text\"/>\n                <input ref={nickNameRef} placeholder=\"nick name\" type=\"text\"/>\n                <button onClick={handleWelcomeSubmit}>Enter room</button>\n              </form>\n            </div>\n            <div id=\"call\" ref={callRef}\n                style={{ display: hidden ? \"none\" : \"block\" }}\n            >\n\n              <div ref={streamBoxRef}>\n                <div ref={streamsRef}>\n                  <div ref={myStreamRef} className=\"people1\">\n                    <video id=\"myFace\"ref={myFaceRef} autoPlay playsInline width=\"400\" height=\"400\"></video>\n                    <h3 ref={userNickNameRef}>\"</h3>\n                  </div>\n                </div>\n                <div ref={controllersRef}>\n                  <div>\n                    <select id=\"cameras\" ref={camerasRef} onChange={handleCameraChange}></select>\n                  </div>\n                  <div>\n                    <div ref={buttonsRef}>\n                      <button id=\"mute\" ref={muteRef} onClick={handleMuteClick}>Mute</button>\n                      <button id=\"camera\" ref={cameraRef} onClick={handleCameraClick}>Turn Camera Off</button>\n                    </div>\n                  </div>\n                  <div>\n                    <button>Leave</button>\n                  </div>\n                </div>\n              </div>\n\n              <div ref={chatRoomRef}>\n                <ul ref={chatBoxRef}>\n                  <form ref={chatFormRef}>\n                    <input type=\"text\" placeholder=\"Write your chat\"/>\n                    <button onClick={handleChatSubmit}>Send</button>\n                  </form>\n                </ul>\n              </div>\n            </div>\n        </div>\n\t\t\t\n\t\t</Container>\n\t);\n}\n\nexport default MainPage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}